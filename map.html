<!DOCTYPE html>
<head>
  <meta name="viewport" content="initial-scale=1.0, width=device-width" />
  <script src="http://js.api.here.com/v3/3.0/mapsjs-core.js" type="text/javascript" charset="utf-8"></script>
  <script src="http://js.api.here.com/v3/3.0/mapsjs-service.js" type="text/javascript" charset="utf-8"></script>
  <script src="http://js.api.here.com/v3/3.0/mapsjs-mapevents.js" type="text/javascript" charset="utf-8"></script>
  <script src="http://js.api.here.com/v3/3.0/mapsjs-ui.js" type="text/javascript" charset="utf-8"></script>
	<link rel="stylesheet" type="text/css" href="http://js.api.here.com/v3/3.0/mapsjs-ui.css" />
</head>
<body>
	<div style="width: 100%; height: 100%; position: absolute;" id="map"></div>
	  <script>
	    // Initialize the platform object
	    var platform = new H.service.Platform({
	      'app_id': 'YEXfVUyzrjN7cxtuR8XU',
	      'app_code': 'hjG4_iVDBPmcz53vxWn4tg',
				useCIT: true,
	  		useHTTPS: true
	    });
	    // Obtain the default layers from the platform object
	    var defaultLayers = platform.createDefaultLayers();
	    // Instantiate a map object
	    var map = new H.Map(
	      document.getElementById('map'),
	      defaultLayers.normal.map,
	      {
	        zoom: 16,
	        center: { lng: -122.3992447, lat: 37.7921209 }
	      }
	    );
	    var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
	    var ui = H.ui.UI.createDefault(map, defaultLayers);
	    ui.addControl("zoomRectangle", new H.ui.ZoomRectangle());
	    var zoomRect = ui.getControl('zoomRectangle');
	    zoomRect.setAlignment('right-middle');
	    // Add window resize listener to adjust the map size
	    window.addEventListener('resize', function() {
	      map.getViewPort().resize();
	    });
	    // Add map context menu event listener
	    map.addEventListener('contextmenu', function(e) {
	      var coord = map.screenToGeo(e.viewportX, e.viewportY);
	      var revGeocodeParams = {
	        prox: coord.lat + ", " + coord.lng,
	        mode: 'retrieveAddresses',
	        maxresults: 1
	      };

	    	var geoCode = platform.getGeocodingService();
	      // reverse geoCode request
	      geoCode.reverseGeocode(revGeocodeParams, function(result) {
	        onResult(result, e);
	      }, function(error) {
	        console.log(error);
	      });
	      // Process geoCode response and adds return associated address
	      function onResult(result, e) {
	        var addressLabel = result.Response.View[0].Result[0];
	        e.items.push(new H.util.ContextItem({
	          label: addressLabel.Location.Address.Label
	        }));
	        e.currentTarget.dispatchEvent(e);
	        e.stopPropagation(e);
	      }
	    });
	  </script>
	</div>
</body>
</html>
